<style>
/* FORCE HEIGHT */
.featured-articles-scroll {
  height: 100vh;
  overflow: hidden;
  background: #fff;
}

.featured-articles-scroll .swiper {
  height: 100%;
}

.featured-articles-scroll .swiper-slide {
  display: flex;
  align-items: center;
}

.featured-article {
  display: grid;
  grid-template-columns: 1fr 1fr auto;
  gap: 4vw;
  padding: 0 6vw;
  width: 100%;
}

.featured-article img {
  width: 100%;
  max-width: 520px;
  display: block;
}

.featured-article h3 {
  font-size: clamp(28px, 3vw, 46px);
  line-height: 1.2;
}

.featured-counter {
  font-size: 14px;
  letter-spacing: 0.2em;
}
</style>

{% assign blog_object = blogs[section.settings.blog] %}

{% if blog_object and blog_object.articles.size > 0 %}

<div class="featured-articles-scroll" {{ section.shopify_attributes }}>
  <div class="swiper featuredArticlesSwiper-{{ section.id }}">
    <div class="swiper-wrapper">

      {% for article in blog_object.articles limit: 5 %}
        <div class="swiper-slide">
          <div class="featured-article">

            <div>
              {% if article.image %}
                <img
                  src="{{ article.image | image_url: width: 1200 }}"
                  alt="{{ article.title | escape }}">
              {% endif %}
            </div>

            <div>
              <h3>{{ article.title }}</h3>
              <a href="{{ article.url }}">Explore</a>
            </div>

            <div class="featured-counter">
              {{ forloop.index | prepend: '0' }}
            </div>

          </div>
        </div>
      {% endfor %}

    </div>
  </div>
</div>



<script>
document.addEventListener('DOMContentLoaded', () => {
  const section = document.querySelector('.featured-articles-scroll');
  if (!section || typeof Swiper === 'undefined') return;

  const swiper = new Swiper('.featuredArticlesSwiper-{{ section.id }}', {
    effect: 'fade',
    fadeEffect: { crossFade: true },
    slidesPerView: 1,
    speed: 600,
    allowTouchMove: false
  });

  let isActive = false;
  let isThrottled = false;

  // Detect when section is centered
  const observer = new IntersectionObserver(
    ([entry]) => {
      isActive = entry.intersectionRatio > 0.6;
    },
    { threshold: [0, 0.6, 1] }
  );

  observer.observe(section);

  window.addEventListener('wheel', (e) => {
    if (!isActive || isThrottled) return;

    const isScrollingDown = e.deltaY > 0;
    const isFirstSlide = swiper.activeIndex === 0;
    const isLastSlide = swiper.activeIndex === swiper.slides.length - 1;

    // ðŸš« Allow normal scroll at edges
    if (
      (isScrollingDown && isLastSlide) ||
      (!isScrollingDown && isFirstSlide)
    ) {
      return; // let page scroll naturally
    }

    // âœ… Intercept scroll only when sliding
    e.preventDefault();
    isThrottled = true;

    if (isScrollingDown) {
      swiper.slideNext();
    } else {
      swiper.slidePrev();
    }

    setTimeout(() => {
      isThrottled = false;
    }, 700);
  }, { passive: false });
});
</script>




{% endif %}

{% schema %}
{
  "name": "Featured Articles Scroll",
  "settings": [
    {
      "type": "blog",
      "id": "blog",
      "label": "Select blog"
    }
  ],
  "presets": [
    {
      "name": "Featured Articles Scroll"
    }
  ]
}
{% endschema %}
