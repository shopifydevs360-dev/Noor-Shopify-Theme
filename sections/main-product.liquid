{{ 'main-product.css' | asset_url | stylesheet_tag }}
{{ 'product-media.css' | asset_url | stylesheet_tag }}
{%- liquid
  assign f_outer_classes = 'main-product'
  assign f_outer_classes = f_outer_classes | append: ' section-' | append: section.id | append: '-padding'
  assign f_outer_classes = f_outer_classes | append: ' m-color-' | append: section.settings.footer_color_scheme
  assign f_outer_classes = f_outer_classes | append: ' ' | append: section.settings.custom_class
  assign f_outer_classes = f_outer_classes | append: ' ' | append: section.settings.color_control
  assign f_inner_classes = ''
  assign f_inner_classes = f_inner_classes | append: ' ' | append: section.settings.container_width
-%}
<section class="main-product">

  <div class="product-layout">

    <!-- =====================
         LEFT: PRODUCT MEDIA
    ====================== -->
{% render 'main-product-media', product: product %}
    <!-- =====================
         RIGHT: PRODUCT INFO
    ====================== -->
    <div class="product-info">

      {% for block in section.blocks %}
        {% case block.type %}

          <!-- TITLE + PRICE -->
          {% when 'title_price' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              <h1>{{ product.title }}</h1>
              <div class="product-price">
                {{ product.price | money }}
              </div>
            </div>

          <!-- REVIEW COUNT -->
          {% when 'review-count' %}
            {% if product.metafields.reviews.count > 0 %}
              {% render 'review-count', product: product, block: block %}
            {% endif %}

          <!-- ADD TO CART FORM -->
          {% when 'add_to_cart_form' %}
            {% render 'main-add-to-cart-form', product: product, block: block %}


          <!-- SHORT DESCRIPTION -->
          {% when 'short_description' %}
            {% if product.metafields.custom.short_description != blank %}
              <div class="product-block" {{ block.shopify_attributes }}>
                {{ product.metafields.custom.short_description }}
              </div>
            {% endif %}


          <!-- FULL DESCRIPTION -->
          {% when 'description' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              {{ product.description }}
            </div>

          <!-- ACCORDION -->
          {% when 'accordion' %}
            {% render 'product-accordion', block: block %}
        {% endcase %}
      {% endfor %}

    </div>

  </div>

</section>
<script src="{{ 'main-product.js' | asset_url }}" defer></script>
<script src="{{ 'product-media.js' | asset_url }}" defer></script>
{% schema %}
{
  "name": "Main product",
  "settings": [],
  "blocks": [
    { "type": "title_price", "name": "Title & price", "limit": 1 },
    { "type": "review-count", "name": "Reviews count", "limit": 1 },
    { "type": "add_to_cart_form", "name": "Add to cart", "limit": 1 },
    { "type": "short_description", "name": "Short description" },
    { "type": "description", "name": "Description" },
    {
      "type": "accordion",
      "name": "Accordion",
      "settings": [
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "richtext", "id": "content", "label": "Content" }
      ]
    }
  ]
}
{% endschema %}
