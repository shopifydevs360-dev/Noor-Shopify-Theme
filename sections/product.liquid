{{ 'product.css' | asset_url | stylesheet_tag }}
<section class="product-page full-width">

  <div class="product-layout">

    <!-- =====================
         LEFT: PRODUCT MEDIA
    ====================== -->
    <div class="product-media">

      {% assign featured_media = product.featured_media %}
      {% assign media_count = product.media.size %}

      <!-- MAIN IMAGE / VIDEO -->
      <div class="product-media__main">
        {% if featured_media.media_type == 'video' %}
          {{ featured_media | video_tag: controls: true, autoplay: false }}
        {% else %}
          <img
            src="{{ featured_media | image_url: width: 1200 }}"
            alt="{{ featured_media.alt | escape }}"
            class="js-zoom-image"
            loading="eager">
        {% endif %}
      </div>

      <!-- SECOND ROW: VIDEO (IF EXISTS) -->
      {% assign has_video = false %}
      {% for media in product.media %}
        {% if media.media_type == 'video' %}
          {% assign has_video = true %}
        {% endif %}
      {% endfor %}

      {% if has_video %}
        <div class="product-media__video-row">
          {% for media in product.media %}
            {% if media.media_type == 'video' %}
              {{ media | video_tag: controls: true }}
            {% endif %}
          {% endfor %}
        </div>
      {% endif %}

      <!-- THIRD ROW: IMAGE SLIDER -->
      {% if media_count > 1 %}
        <div class="product-media__thumbs swiper">
          <div class="swiper-wrapper">

            {% for media in product.media %}
              {% if media.media_type == 'image' %}
                <div class="swiper-slide">
                  <img
                    src="{{ media | image_url: width: 400 }}"
                    alt="{{ media.alt | escape }}"
                    data-full="{{ media | image_url: width: 1200 }}"
                    class="js-thumb">
                </div>
              {% endif %}
            {% endfor %}

          </div>
        </div>
      {% endif %}

    </div>

    <!-- =====================
         RIGHT: PRODUCT INFO
    ====================== -->
    <div class="product-info">

      {% for block in section.blocks %}
        {% case block.type %}

          <!-- TITLE + PRICE -->
          {% when 'title_price' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              <h1>{{ product.title }}</h1>
              <div class="product-price">
                {{ product.price | money }}
              </div>
            </div>

          <!-- REVIEW COUNT -->
          {% when 'reviews' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              <div class="product-reviews">
                ⭐⭐⭐⭐⭐ <span>({{ product.metafields.reviews.count | default: 0 }})</span>
              </div>
            </div>

          <!-- ADD TO CART FORM -->
          {% when 'buy_form' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              {% form 'product', product %}

                <!-- VARIANTS -->
                {% unless product.has_only_default_variant %}
                  {% for option in product.options_with_values %}
                    <fieldset class="variant-group">
                      <legend>{{ option.name }}</legend>
                      <div class="variant-buttons">
                        {% for value in option.values %}
                          <label class="variant-btn">
                            <input
                              type="radio"
                              name="options[{{ option.name }}]"
                              value="{{ value }}"
                              {% if option.selected_value == value %}checked{% endif %}>
                            <span>{{ value }}</span>
                          </label>
                        {% endfor %}
                      </div>
                    </fieldset>
                  {% endfor %}
                {% endunless %}

                <!-- QUANTITY DROPDOWN -->
                <label>
                  Quantity
                  <select name="quantity">
                    {% for i in (1..10) %}
                      <option value="{{ i }}">{{ i }}</option>
                    {% endfor %}
                  </select>
                </label>

                <button type="submit" class="btn btn--primary">
                  Add to cart
                </button>

              {% endform %}
            </div>

          <!-- SHORT DESCRIPTION -->
          {% when 'short_description' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              {{ product.metafields.custom.short_description }}
            </div>

          <!-- FULL DESCRIPTION -->
          {% when 'description' %}
            <div class="product-block" {{ block.shopify_attributes }}>
              {{ product.description }}
            </div>

          <!-- ACCORDION -->
          {% when 'accordion' %}
            <div class="product-block accordion" {{ block.shopify_attributes }}>
              <details>
                <summary>{{ block.settings.title }}</summary>
                <div class="accordion-content">
                  {{ block.settings.content }}
                </div>
              </details>
            </div>

        {% endcase %}
      {% endfor %}

    </div>

  </div>

</section>
<script src="{{ 'product.js' | asset_url }}" defer></script>
{% schema %}
{
  "name": "Main product",
  "settings": [],
  "blocks": [
    { "type": "title_price", "name": "Title & price", "limit": 1 },
    { "type": "reviews", "name": "Reviews", "limit": 1 },
    { "type": "buy_form", "name": "Add to cart", "limit": 1 },
    { "type": "short_description", "name": "Short description" },
    { "type": "description", "name": "Description" },
    {
      "type": "accordion",
      "name": "Accordion",
      "settings": [
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "richtext", "id": "content", "label": "Content" }
      ]
    }
  ]
}
{% endschema %}
