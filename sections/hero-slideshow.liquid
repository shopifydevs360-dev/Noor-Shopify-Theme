{{ 'hero-slideshow.css' | asset_url | stylesheet_tag: preload: true }}

<div id="shopify-section-{{ section.id }}" class="shopify-section hero-slideshow">
  <header class="hero-slideshow__inner full-screen-slideshow">

    <!-- LEFT SIDEBAR IMAGE -->
    <aside class="hero-slideshow__sidebar">
      {% if section.settings.sidebar_image != blank %}
        <img
          src="{{ section.settings.sidebar_image | image_url: width: 800 }}"
          alt="{{ section.settings.sidebar_image.alt | escape }}"
          loading="lazy"
        >
      {% endif %}
    </aside>

    <!-- RIGHT SLIDER -->
    <div class="hero-slideshow__slider swiper myswiper-{{ section.id }}">
      <div class="swiper-wrapper">

        {% for block in section.blocks %}
          <div class="swiper-slide hero-slideshow__slide" {{ block.shopify_attributes }}>

            <!-- MEDIA -->
            <div class="hero-slideshow__media">
              {% if block.type == 'image_slide' and block.settings.image_desktop != blank %}
                <picture>
                  {% if block.settings.image_mobile != blank %}
                    <source media="(max-width: 767px)" srcset="{{ block.settings.image_mobile | image_url: width: 800 }}">
                  {% endif %}
                  <img
                    src="{{ block.settings.image_desktop | image_url: width: 1800 }}"
                    alt="{{ block.settings.image_desktop.alt | escape }}"
                    loading="lazy"
                  >
                </picture>

              {% elsif block.type == 'video_slide' and block.settings.video_desktop != blank %}
                <video autoplay muted loop playsinline>
                  {% if block.settings.video_mobile != blank %}
                    <source src="{{ block.settings.video_mobile }}" media="(max-width: 767px)">
                  {% endif %}
                  <source src="{{ block.settings.video_desktop }}">
                </video>
              {% endif %}
            </div>

            <!-- OVERLAY -->
            <div
              class="hero-slideshow__overlay"
              style="
                --overlay-color: {{ block.settings.overlay_color }};
                --overlay-opacity: {{ block.settings.overlay_opacity | divided_by: 100.0 }};
              ">
            </div>

            <!-- CONTENT -->
            <div class="hero-slideshow__content-wrapper content-width-{{ block.settings.content_width }}
                        align-x-{{ block.settings.horizontal_alignment }}
                        align-y-{{ block.settings.vertical_alignment }}">

              <div
                class="hero-slideshow__content text-{{ block.settings.text_alignment }}"
                style="
                  --content-bg: {{ block.settings.background }};
                  --content-blur: {{ block.settings.background_blur }}px;
                "
              >
                {% if block.settings.subheading != blank %}
                  <h4 class="{{ block.settings.subheading_size }}">
                    {{ block.settings.subheading }}
                  </h4>
                {% endif %}

                {% if block.settings.heading != blank %}
                  <h2 class="{{ block.settings.heading_size }}">
                    {{ block.settings.heading }}
                  </h2>
                {% endif %}

                {% if block.settings.text != blank %}
                  <div class="rte {{ block.settings.text_size }}">
                    {{ block.settings.text }}
                  </div>
                {% endif %}

                {% if block.settings.cta_text != blank %}
                  <a href="{{ block.settings.link }}" class="arrow-link">
                    {{ block.settings.cta_text }}
                  </a>
                {% endif %}
              </div>
            </div>

          </div>
        {% endfor %}
      </div>

      <!-- NAV -->
      <div class="hero-slideshow__nav">
        <button class="js-prev">Previous</button>
        <button class="js-next">Next</button>
      </div>
    </div>
  </header>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  new Swiper('.myswiper-{{ section.id }}', {
    loop: true,
    effect: 'fade',
    fadeEffect: { crossFade: true },
    {% if section.settings.enable_autoplay %}
    autoplay: {
      delay: 3000,
      disableOnInteraction: false
    },
    {% endif %}
    navigation: {
      nextEl: '.js-next',
      prevEl: '.js-prev'
    }
  });
});
</script>


{% schema %}
{
  "name": "Hero Slideshow",
  "max_blocks": 10,
  "settings": [
    {
      "type": "image_picker",
      "id": "sidebar_image",
      "label": "Sidebar Image"
    },
    {
      "type": "checkbox",
      "id": "enable_autoplay",
      "label": "Enable Autoplay",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "image_slide",
      "name": "Image Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide Image"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "cta_text",
          "label": "CTA Text"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Slide Link"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#f3e3d3"
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "Overlay Color",
          "default": "#000000"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Overlay Opacity",
          "min": 0,
          "max": 1,
          "step": 0.1,
          "default": 0.0
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#000000"
        }
      ]
    },
    {
      "type": "video_slide",
      "name": "Video Slide (Self-Hosted)",
      "settings": [
        {
          "type": "text",
          "id": "video_url_desktop",
          "label": "MP4 Video URL - Desktop"
        },
        {
          "type": "text",
          "id": "video_url_mobile",
          "label": "MP4 Video URL - Mobile (optional)"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#000000"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Slideshow",
      "category": "Image",
      "blocks": [
        {
          "type": "image_slide"
        },
        {
          "type": "video_slide"
        }
      ]
    }
  ]
}
{% endschema %}
