{{ 'hero-slideshow.css' | asset_url | stylesheet_tag: preload: true }}

<div id="shopify-section-{{ section.id }}" class="shopify-section hero-outer-wrap">
  <header class="reverse-nav full-screen-slideshow sidebar-slideshow js-animate-on-load" data-trigger="scroll">
    
    <div class="sidebar-image">
      <div class="sliding-img-wrapper large-image" data-swipe-dir="right" data-shape="square" data-slide-order="">
        <div class="img-slide-bg" style="background-color: #f3e3d3;"></div>
        <div class="cropped-image-wrapper">
          <img class="lazyload" data-src="{{ section.settings.sidebar_image | img_url: 'master' }}" data-sizes="auto" alt="{{ section.settings.sidebar_image.alt | escape }}" height="auto" width="auto" loading="lazy">
        </div>
      </div>
    </div>

    <div class="swiper-container swiper-container-hero myswiper-{{ section.id }}">
      <div class="swiper-wrapper">

        {% for block in section.blocks %}
          <div class="swiper-slide image-with-text-overlay"
               style="color: {{ block.settings.text_color }}; background-color: {{ block.settings.background_color }};"
               data-text-color="{{ block.settings.text_color }}">

            {% if block.type == 'image_slide' %}
              <a href="{{ block.settings.link }}">
                <span class="overlay-bg"
                      style="background-color: {{ block.settings.overlay_color }}; opacity: {{ block.settings.overlay_opacity }};"></span>

                <div class="cropped-image-wrapper">
                  <img class="lazyload"
                       src="{{ block.settings.image | img_url: 'master' }}"
                       alt="{{ block.settings.image.alt | escape }}"
                       data-sizes="auto"
                       data-parent-fit="contain"
                       data-optimumx="1.5" height="auto" width="auto" loading="lazy">
                </div>

                <div class="js-hero-swiper-text text-content text-content--bottom-left sh-container"
                     style="background-color: transparent">
                  {% if block.settings.subheading != blank %}
                    <h2 class="hd-6" data-reveal="lines-masked-delayed" data-delay=".8">{{ block.settings.subheading }}</h2>
                  {% endif %}
                  {% if block.settings.heading != blank %}
                    <h2 class="hd-2" data-reveal="lines-masked-delayed" data-delay="1">{{ block.settings.heading }}</h2>
                  {% endif %}
                  {% if block.settings.cta_text != blank %}
                    <p class="arrow-link" data-reveal="lines-masked-delayed" data-delay="1.5">
                      <span>{{ block.settings.cta_text }}</span>
                      <span class="icon">{{ 'icon-arrow-right.svg' | inline_asset_content }}</span>
                    </p>
                  {% endif %}
                </div>
              </a>

            {% elsif block.type == 'video_slide' and block.settings.video_url_desktop != blank %}
              <div class="video-wrapper cropped-image-wrapper">
                <video autoplay muted loop playsinline
                       style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;">
                  <source src="{{ block.settings.video_url_desktop }}" type="video/mp4" media="(min-width: 768px)">
                  <source src="{{ block.settings.video_url_mobile | default: block.settings.video_url_desktop }}" type="video/mp4" media="(max-width: 767px)">
                  Your browser does not support the video tag.
                </video>
              </div>
            {% endif %}
          </div>
        {% endfor %}

      </div>
    </div>

    <div class="swiper-nav-wrapper js-hero-swiper-nav">
      <button type="button" class="js-prev swiper-prev-text text-only">
        <span class="inner-text">Previous</span>
      </button>
      <button type="button" class="js-next swiper-next-text text-only">
        <span class="line"></span>
        <span class="inner-text">Next</span>
      </button>
    </div>
  </header>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var heroSwiper = new Swiper('.myswiper-{{ section.id }}', {
      allowTouchMove: true,
      updateOnWindowResize: true,
      loop: true,
      {% if section.settings.enable_autoplay %}
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      {% endif %}
      navigation: {
        nextEl: '.js-next',
        prevEl: '.js-prev',
      },
      effect: "fade",
      fadeEffect: { crossFade: true }
    });
  });
</script>

{% schema %}
{
  "name": "Hero Slideshow",
  "max_blocks": 10,
  "settings": [
    {
      "type": "image_picker",
      "id": "sidebar_image",
      "label": "Sidebar Image"
    },
    {
      "type": "checkbox",
      "id": "enable_autoplay",
      "label": "Enable Autoplay",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "image_slide",
      "name": "Image Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide Image"
        },
        {
          "type": "text",
          "id": "subheading",
          "label": "Subheading"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "cta_text",
          "label": "CTA Text"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Slide Link"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#f3e3d3"
        },
        {
          "type": "color",
          "id": "overlay_color",
          "label": "Overlay Color",
          "default": "#000000"
        },
        {
          "type": "range",
          "id": "overlay_opacity",
          "label": "Overlay Opacity",
          "min": 0,
          "max": 1,
          "step": 0.1,
          "default": 0.0
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#000000"
        }
      ]
    },
    {
      "type": "video_slide",
      "name": "Video Slide (Self-Hosted)",
      "settings": [
        {
          "type": "text",
          "id": "video_url_desktop",
          "label": "MP4 Video URL - Desktop"
        },
        {
          "type": "text",
          "id": "video_url_mobile",
          "label": "MP4 Video URL - Mobile (optional)"
        },
        {
          "type": "color",
          "id": "background_color",
          "label": "Background Color",
          "default": "#000000"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text Color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero Slideshow",
      "category": "Image",
      "blocks": [
        {
          "type": "image_slide"
        },
        {
          "type": "video_slide"
        }
      ]
    }
  ]
}
{% endschema %}
