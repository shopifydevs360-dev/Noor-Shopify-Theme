<div class="product-block product-form-wrapper" {{ block.shopify_attributes }}>
  {% form 'product', product, class: 'product-form' %}
    {% assign v = product.selected_or_first_available_variant %}

    <!-- REQUIRED VARIANT ID -->
    <input type="hidden" name="id" value="{{ v.id }}">

    <!-- VARIANTS -->
    {% unless product.has_only_default_variant %}
      {% for option in product.options_with_values %}
        <fieldset class="variant-group" data-option-index="{{ forloop.index0 }}">
          <legend>{{ option.name }}</legend>

          <div class="variant-buttons">
            {% for value in option.values %}
              <label class="variant-btn">
                <input
                  type="radio"
                  name="options[{{ option.name }}]"
                  value="{{ value }}"
                  {% if option.selected_value == value %}checked{% endif %}
                >
                <span>{{ value }}</span>
              </label>
            {% endfor %}
          </div>
        </fieldset>
      {% endfor %}
    {% endunless %}

    <!-- QUANTITY -->
    <div class="quantity-selector">
      <label class="product-quantity">
        <select name="quantity">
          {% for i in (1..12) %}
            <option value="{{ i }}">Qty {{ i }}</option>
          {% endfor %}
        </select>
      </label>
    </div>

    <!-- ADD TO CART (ONLY REAL STOCK) -->
    <div class="product-actions" data-cart-behavior="{{ block.settings.cart_behavior }}">
      <button
        type="submit"
        class="btn btn--primary btn-add-to-cart"
        data-role="add-to-cart"
        {% if v.inventory_quantity <= 0 %}disabled{% endif %}
      >
        {% if v.inventory_quantity > 0 %}
          Add to cart
        {% else %}
          Out of stock
        {% endif %}
      </button>
    </div>

    <!-- BUY / PREORDER / NOTIFY -->
    <div class="quick-checkout">
      {% if v.inventory_quantity > 0 %}
        <button type="button" class="btn btn--secondary btn-buy-now" data-role="buy-now">
          Buy it now
        </button>
        <button type="button" class="btn btn--secondary btn-notify hide" data-role="notify">
          Notify me when available
        </button>

      {% elsif v.inventory_policy == 'continue' %}
        <button type="button" class="btn btn--secondary btn-buy-now" data-role="buy-now">
          Pre-order
        </button>
        <button type="button" class="btn btn--secondary btn-notify hide" data-role="notify">
          Notify me when available
        </button>

      {% else %}
        <button type="button" class="btn btn--secondary btn-buy-now hide" data-role="buy-now">
          Buy it now
        </button>
        <button type="button" class="btn btn--secondary btn-notify" data-role="notify">
          Notify me when available
        </button>
      {% endif %}
    </div>

  {% endform %}
</div>
