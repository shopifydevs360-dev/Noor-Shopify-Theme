<div class="product-block product-form-wrapper" {{ block.shopify_attributes }}>

  {% form 'product', product, class: 'product-form' %}

    <!-- REQUIRED VARIANT ID -->
    <input
      type="hidden"
      name="id"
      value="{{ product.selected_or_first_available_variant.id }}"
    >

    <!-- VARIANTS -->
    {% unless product.has_only_default_variant %}
      {% for option in product.options_with_values %}
        <fieldset class="variant-group" data-option-index="{{ forloop.index0 }}">
          <legend>{{ option.name }}</legend>

          <div class="variant-buttons">
            {% for value in option.values %}
              <label class="variant-btn">
                <input
                  type="radio"
                  name="options[{{ option.name }}]"
                  value="{{ value }}"
                  {% if option.selected_value == value %}checked{% endif %}
                >
                <span>{{ value }}</span>
              </label>
            {% endfor %}
          </div>
        </fieldset>
      {% endfor %}
    {% endunless %}

    <div class="quantity-selector">
      <label class="product-quantity">
        <select name="quantity">
          {% assign quantities = "1,2,3,4,5,6,7,8,9,10,11,12" | split: "," %}
          {% for qty in quantities %}
            <option value="{{ qty }}">Qty {{ qty }}</option>
          {% endfor %}
        </select>
      </label>
    </div>


{% assign current_variant = product.selected_or_first_available_variant %}
{% assign is_available = current_variant.available %}
{% assign can_preorder = current_variant.inventory_policy == 'continue' %}

<!-- ACTION BUTTONS -->
<div class="product-actions" data-cart-behavior="{{ block.settings.cart_behavior }}">

  {% if is_available %}
    <!-- IN STOCK -->
    <button
      type="submit"
      class="btn btn--primary btn-add-to-cart"
      data-action="add-to-cart"
    >
      Add to cart
    </button>

  {% elsif can_preorder %}
    <!-- PRE ORDER -->
    <button
      type="submit"
      class="btn btn--primary btn-add-to-cart btn--preorder"
      data-action="add-to-cart"
    >
      Pre-order
    </button>

  {% else %}
    <!-- OUT OF STOCK -->
    <button
      type="button"
      class="btn btn--primary btn--disabled"
      disabled
      aria-disabled="true"
    >
      Out of stock
    </button>
  {% endif %}

</div>

<!-- QUICK CHECKOUT / BUY IT NOW -->
<div class="quick-checkout">

  {% if is_available or can_preorder %}
    <!-- BUY IT NOW (NORMAL) -->
    <button
      type="button"
      class="btn btn--secondary btn-buy-now"
      data-action="buy-now"
    >
      Buy it now
    </button>

  {% else %}
    <!-- NOTIFY ME -->
    <button
      type="button"
      class="btn btn--secondary btn-notify"
      data-action="notify"
    >
      Notify me when available
    </button>
  {% endif %}

</div>


  {% endform %}

</div>
